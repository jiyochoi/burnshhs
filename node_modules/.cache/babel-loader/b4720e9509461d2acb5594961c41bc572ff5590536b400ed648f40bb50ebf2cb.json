{"ast":null,"code":"import _objectWithoutProperties from\"/Users/jiyochoi/burstshhs/burstshhs/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _regeneratorRuntime from\"/Users/jiyochoi/burstshhs/burstshhs/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jiyochoi/burstshhs/burstshhs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jiyochoi/burstshhs/burstshhs/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _excluded=[\"score\"];import{render}from'@testing-library/react';import{CSSTransition}from'react-transition-group';import React,{useEffect,useState,useCallback}from'react';import'./App.css';import gunSound from'./snd/gun2.mp3';import backgroundSound from'./snd/jyo.mp3';import Join from'./Join';import Info from'./Info';import Ranking from'./Ranking';import{getScore,addScore}from'./api';import{debounce}from'lodash';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var bgm=new Audio(backgroundSound);function App(){var getImg=function getImg(){return\"img/hakgyo.png\";};var nodeRef=React.useRef(null);var _useState=useState(0),_useState2=_slicedToArray(_useState,2),click=_useState2[0],setClick=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),clickState=_useState4[0],setClickState=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),bgmState=_useState6[0],setBgmState=_useState6[1];var _useState7=useState(getImg),_useState8=_slicedToArray(_useState7,2),hakgyoImg=_useState8[0],setHakgyoImg=_useState8[1];var _useState9=useState(\"img/audio_on.png\"),_useState10=_slicedToArray(_useState9,2),audioImg=_useState10[0],setAudioImg=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isJoin=_useState12[0],setIsJoin=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isInfo=_useState14[0],setIsInfo=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isRank=_useState16[0],setIsRank=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),player=_useState18[0],setPlayer=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),classScore=_useState20[0],setClassScore=_useState20[1];var onClickInfo=function onClickInfo(){setIsInfo(true);};var onClickRank=function onClickRank(){setIsRank(true);};var syncClassScore=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=setClassScore;_context.next=3;return getScore(player.grade,player.class);case 3:_context.t1=_context.sent;(0,_context.t0)(_context.t1);case 5:case\"end\":return _context.stop();}}},_callee);}));return function syncClassScore(){return _ref.apply(this,arguments);};}();var uploadClicks=useCallback(debounce(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(player,click){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return addScore(player.grade,player.class,click);case 2:_context2.next=4;return syncClassScore();case 4:setClick(0);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}(),2000),[]);/*\n  const useAudio = () => {\n    const [loaded, setLoaded] = useState(0);\n\n    useEffect(() => {\n      //AudioContext 생성\n      const AudioContext = window.AudioContext || window.webkitAudioContext;\n      const audioContext = new AudioContext();\n\n      //AudioContext를 통해 AudioBufferSourceNode 생성\n      const fromis9 = [];\n\n      fromis9.push(\n        new Promise(async(resolve) => {\n          //오디오 파일 로드\n          const res = await fetch(\"snd/gun2.mp3\");\n          //arrayBuffer로 이진 데이터로 변환\n          const arrayBuffer = await res.ArrayBuffer;\n          //AudioContext를 통해 AudioBuffer 생성\n          const audioBuffer = await AudioContext.decodeAudioData(arrayBuffer);\n          //AudioBufferSourceNode 생성\n          const AudioBufferSourceNode = await audioContext.createBufferSource();\n          \n          //AudioBufferSourceNode에 AudioBuffer 연결\n          AudioBufferSourceNode.buffer = audioBuffer;\n          //스피커에 연결\n          AudioBufferSourceNode.connect(audioContext.destination);\n\n          AudioBufferSourceNode.start();\n\n          resolve();\n        })\n      );\n\n      Promise.all(fromis9).then(() => {\n        setLoaded(true);\n      })\n    });\n\n    return{\n      loaded,\n      audios\n    };\n  }\n*/var audio=new Audio(gunSound);audio.loop=false;audio.volume=0.5;bgm.loop=true;bgm.volume=0.3;var toggleBackgroundMusic=function toggleBackgroundMusic(){return setBgmState(function(old){return!old;});};useEffect(function(){if(bgmState){bgm.play();setAudioImg(\"img/audio_on.png\");}else{bgm.pause();bgm.currentTime=0;setAudioImg(\"img/audio_off.png\");}},[bgmState]);var StartClick=function StartClick(){if(!isJoin||isInfo)return;setClick(click+1);setClickState(false);setHakgyoImg(\"img/hakgyoboom.png\");audio.play();};var endClick=function endClick(){if(!isJoin||isInfo)return;setClickState(true);setHakgyoImg(getImg);uploadClicks(player,click);};return/*#__PURE__*/_jsxs(\"div\",{onPointerDown:StartClick,onPointerUp:endClick,onLostPointerCapture:endClick,children:[/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:!isJoin?/*#__PURE__*/_jsx(Join,{open:!isJoin,onJoin:function onJoin(_ref3){var score=_ref3.score,playerData=_objectWithoutProperties(_ref3,_excluded);setPlayer(playerData);setClassScore(score);setIsJoin(true);}}):\"\".concat(player.class,\"-\").concat(player.grade,\" \").concat(player.name)}),/*#__PURE__*/_jsx(\"h1\",{children:\"BURN SeoHyunHighSchool\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"states\",children:[/*#__PURE__*/_jsx(\"img\",{id:\"audiostate\",src:audioImg,onClick:toggleBackgroundMusic}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{id:\"rank\",src:\"img/rank.png\",onClick:onClickRank}),isRank&&/*#__PURE__*/_jsx(Ranking,{open:isRank,onClose:function onClose(){setIsRank(false);}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{id:\"info\",src:\"img/info.png\",onClick:onClickInfo}),isInfo&&/*#__PURE__*/_jsx(Info,{open:isInfo,onClose:function onClose(){setIsInfo(false);}})]})]}),/*#__PURE__*/_jsx(CSSTransition,{nodeRef:nodeRef,in:clickState,timeout:30,classNames:\"hakgyo\",onEnter:function onEnter(){setHakgyoImg(\"img/hakgyo.png\");},onExited:function onExited(){setHakgyoImg(\"img/hakgyoboom.png\");},children:/*#__PURE__*/_jsx(\"div\",{className:\"count\",children:click+classScore})}),/*#__PURE__*/_jsx(\"img\",{class:\"hakgyo\",src:hakgyoImg})]});}export default App;","map":{"version":3,"names":["render","CSSTransition","React","useEffect","useState","useCallback","gunSound","backgroundSound","Join","Info","Ranking","getScore","addScore","debounce","bgm","Audio","App","getImg","nodeRef","useRef","click","setClick","clickState","setClickState","bgmState","setBgmState","hakgyoImg","setHakgyoImg","audioImg","setAudioImg","isJoin","setIsJoin","isInfo","setIsInfo","isRank","setIsRank","player","setPlayer","classScore","setClassScore","onClickInfo","onClickRank","syncClassScore","grade","class","uploadClicks","audio","loop","volume","toggleBackgroundMusic","old","play","pause","currentTime","StartClick","endClick","score","playerData","name"],"sources":["/Users/jiyochoi/burstshhs/burstshhs/src/App.js"],"sourcesContent":["import { render } from '@testing-library/react';\nimport { CSSTransition } from 'react-transition-group'\nimport React, { useEffect, useState, useCallback } from 'react';\nimport './App.css';\nimport gunSound from './snd/gun2.mp3';\nimport backgroundSound from './snd/jyo.mp3';\nimport Join from './Join';\nimport Info from './Info';\nimport Ranking from './Ranking';\nimport { getScore, addScore } from './api';\nimport { debounce } from 'lodash';\n\nconst bgm = new Audio(backgroundSound);\n\nfunction App() {\n  \n  const getImg = () => {\n    return \"img/hakgyo.png\";\n  }\n\n  const nodeRef = React.useRef(null);\n\n  const [click, setClick] = useState(0);\n\n  const [clickState, setClickState] = useState(false);\n\n  const [bgmState, setBgmState] = useState(true);\n\n  const [hakgyoImg, setHakgyoImg] = useState(getImg);\n\n  const [audioImg, setAudioImg] = useState(\"img/audio_on.png\");\n  const [isJoin, setIsJoin] = useState(false);\n  const [isInfo, setIsInfo] = useState(false);\n  const [isRank, setIsRank] = useState(false);\n  const [player, setPlayer] = useState(null);\n  const [classScore, setClassScore] = useState(0);\n\n  const onClickInfo = () => {\n    setIsInfo(true);\n  }\n  const onClickRank = () => {\n    setIsRank(true);\n  }\n\n  const syncClassScore = async () => {\n    setClassScore(await getScore(player.grade, player.class));\n  }\n\n  const uploadClicks = useCallback(debounce(async (player, click) => {\n    await addScore(player.grade, player.class, click);\n    await syncClassScore();\n    setClick(0);\n  }, 2000), []);\n/*\n  const useAudio = () => {\n    const [loaded, setLoaded] = useState(0);\n\n    useEffect(() => {\n      //AudioContext 생성\n      const AudioContext = window.AudioContext || window.webkitAudioContext;\n      const audioContext = new AudioContext();\n\n      //AudioContext를 통해 AudioBufferSourceNode 생성\n      const fromis9 = [];\n\n      fromis9.push(\n        new Promise(async(resolve) => {\n          //오디오 파일 로드\n          const res = await fetch(\"snd/gun2.mp3\");\n          //arrayBuffer로 이진 데이터로 변환\n          const arrayBuffer = await res.ArrayBuffer;\n          //AudioContext를 통해 AudioBuffer 생성\n          const audioBuffer = await AudioContext.decodeAudioData(arrayBuffer);\n          //AudioBufferSourceNode 생성\n          const AudioBufferSourceNode = await audioContext.createBufferSource();\n          \n          //AudioBufferSourceNode에 AudioBuffer 연결\n          AudioBufferSourceNode.buffer = audioBuffer;\n          //스피커에 연결\n          AudioBufferSourceNode.connect(audioContext.destination);\n\n          AudioBufferSourceNode.start();\n\n          resolve();\n        })\n      );\n\n      Promise.all(fromis9).then(() => {\n        setLoaded(true);\n      })\n    });\n\n    return{\n      loaded,\n      audios\n    };\n  }\n*/\n  const audio = new Audio(gunSound);\n  audio.loop = false;\n  audio.volume = 0.5;\n\n  bgm.loop = true;\n  bgm.volume = 0.3;\n\n  const toggleBackgroundMusic = () => setBgmState(old => !old);\n  \n  useEffect(() => {\n    if (bgmState) {\n      bgm.play();\n      setAudioImg(\"img/audio_on.png\");\n    } else{\n      bgm.pause();\n      bgm.currentTime = 0;\n      setAudioImg(\"img/audio_off.png\");\n    }\n  }, [bgmState])\n  \n  const StartClick = () => {\n    if (!isJoin || isInfo) return;\n    setClick(click + 1);\n    setClickState(false);\n    setHakgyoImg(\"img/hakgyoboom.png\");\n    audio.play();\n  }\n\n  const endClick = () => {\n    if (!isJoin || isInfo) return;\n    setClickState(true);\n    setHakgyoImg(getImg);\n    uploadClicks(player, click);\n  }\n\n  return(\n    <div onPointerDown={StartClick} onPointerUp={endClick} onLostPointerCapture={endClick}>\n          <div className=\"App\">\n            {\n              !isJoin \n              ? (\n                <Join\n                  open={!isJoin}\n                  onJoin={({ score, ...playerData }) => {\n                    setPlayer(playerData);\n                    setClassScore(score);\n                    setIsJoin(true);\n                  }}\n                />)\n              : `${player.class}-${player.grade} ${player.name}`\n            }\n          </div>\n      <h1>BURN SeoHyunHighSchool</h1>\n      <div class = \"states\">\n        <img id = \"audiostate\" src = {audioImg} onClick={toggleBackgroundMusic} />\n        <div>\n          <img id = \"rank\" src = \"img/rank.png\" onClick={onClickRank}/>\n          {isRank && (<Ranking\n            open={isRank}\n            onClose={() => {\n              setIsRank(false);\n            }}\n          />)}\n          </div>\n        <div>\n          <img id = \"info\" src = \"img/info.png\" onClick={onClickInfo}/>\n          {isInfo && (<Info\n            open={isInfo}\n            onClose={() => {\n              setIsInfo(false);\n            }}\n          />)}\n          </div>\n      </div>\n      <CSSTransition\n        nodeRef={nodeRef}\n        in={clickState}\n        timeout={30}\n        classNames=\"hakgyo\"\n        onEnter={()=>{setHakgyoImg(\"img/hakgyo.png\");}}\n        onExited={()=>{setHakgyoImg(\"img/hakgyoboom.png\");}}\n        >\n        <div className=\"count\">{click + classScore}</div>\n      </CSSTransition>\n      <img class=\"hakgyo\" src={hakgyoImg} />\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}